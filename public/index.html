<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Abarrotes KaChu ‚Äî Cat√°logo</title>
  <link rel="stylesheet" href="styles.css">
  <!--<link rel="manifest" href="/manifest.json">-->
  <link rel="manifest" href="/manifest.webmanifest">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16.png">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-180.png">
  <meta name="theme-color" content="#1e40af">
  <!-- Android/Chromium (opcional hoy, silencia el warning) -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>
  <!-- BARRA SUPERIOR STICKY -->
  <header class="topbar">
    <div class="filters">
      <div class="row">
        <label class="field">
          <span>Categor√≠a</span>
          <select id="category">
            <option value="">Todas</option>
          </select>
        </label>
        <label class="field">
          <span>Subcategor√≠a</span>
          <select id="subcategory">
            <option value="">Todas</option>
          </select>
        </label>
      </div>

      <div class="row">
        <label class="field field-search">
          <span>Buscar producto</span>
          <input id="searchInput" type="search" placeholder="Escribe el nombre‚Ä¶">
        </label>
      </div>
    </div>
  </header>
<!-- ================= FAVORITOS: carrusel ================= -->
<section class="favs" id="favsSection" role="region" aria-label="Tus favoritos">
  <div class="favs-head">
    <h3 class="favs-title">‚≠ê Tus favoritos</h3>

    <div class="favs-actions">
      <!-- Flechas: el JS las mostrar√°/ocultar√° seg√∫n haya m√°s √≠tems -->
      <button class="favs-nav" id="favsPrev" type="button" aria-label="Anterior" aria-hidden="true" hidden>‚Äπ</button>
      <button class="favs-nav" id="favsNext" type="button" aria-label="Siguiente" aria-hidden="true" hidden>‚Ä∫</button>

      <button class="btn small" id="favsAll" type="button">Ver todos</button>
    </div>
  </div>

  <div class="favs-viewport" aria-live="polite">
    <div class="favs-track" id="favsTrack" aria-label="Carrusel de favoritos">
      <!-- Aqu√≠ el JS inyecta <article class="fav-card">‚Ä¶ -->
    </div>
  </div>

  <!-- Puntitos de paginaci√≥n (1 por ‚Äúpaso/grupo‚Äù) -->
  <div class="favs-dots" id="favsDots" aria-label="Indicadores"></div>
</section>
<!-- =============== /FAVORITOS: carrusel ================== -->

  <!-- Rail de redes -->
  <div class="social-fabs" aria-label="Redes sociales">
    <div class="fab" data-net="fb">
      <button class="fab-btn" aria-expanded="false" title="Facebook" type="button">
        <span class="fab-icon-wrap" aria-hidden="true">
          <svg class="fab-icon" viewBox="0 0 24 24">
            <path d="M22 12.06C22 6.48 17.52 2 11.94 2S2 6.48 2 12.06c0 5 3.66 9.14 8.44 9.94v-7.03H8.41V12.06h2.03V9.95c0-2 1.2-3.1 3.03-3.1.88 0 1.81.16 1.81.16v1.99h-1.02c-1 0-1.31.62-1.31 1.26v1.8h2.23l-.36 2.91h-1.87V22c4.78-.8 8.44-4.94 8.44-9.94Z"/>
          </svg>
        </span>
        <span class="fab-text">
          <span class="fab-subtitle">S√≠guenos en:</span>
          <a class="fab-title" href="https://www.facebook.com/AbarrotesKaChu"
             target="_blank" rel="noopener" data-name="Abarrotes KaChu">Abarrotes KaChu</a>
        </span>
      </button>
    </div>
    <div class="fab" data-net="wa">
      <button class="fab-btn" aria-expanded="false" title="WhatsApp" type="button">
        <span class="fab-icon-wrap" aria-hidden="true">
          <svg class="fab-icon" viewBox="0 0 24 24">
            <path d="M20.52 3.48A11.86 11.86 0 0 0 12.02 0 11.97 11.97 0 0 0 2.23 17.45L0 24l6.73-2.22a11.9 11.9 0 0 0 5.3 1.27h.01c6.6 0 11.96-5.36 11.96-11.95 0-3.2-1.24-6.2-3.48-8.62ZM12.04 21.3h-.01c-1.73 0-3.43-.46-4.92-1.32l-.35-.2-4 1.31 1.32-3.9-.23-.4A9.24 9.24 0 0 1 2.8 12c0-5.09 4.15-9.24 9.25-9.24 2.47 0 4.79.96 6.53 2.7a9.17 9.17 0 0 1 2.71 6.53c0 5.1-4.15 9.26-9.25 9.26Zm5.22-6.92c-.29-.15-1.7-.84-1.96-.93-.26-.09-.45-.15-.64.15-.19.3-.74.93-.9 1.12-.17.19-.33.21-.62.08-.29-.15-1.22-.45-2.32-1.44-.86-.76-1.44-1.7-1.61-1.99-.17-.29-.02-.44.13-.59.13-.13.29-.33.43-.49.15-.17.19-.29.29-.48.1-.19.05-.36-.02-.51-.08-.15-.64-1.54-.88-2.11-.23-.55-.47-.47-.64-.48h-.55c-.19 0-.5.07-.76.36-.26.29-1 1-1 2.43 0 1.43 1.03 2.81 1.17 3 .15.19 2.02 3.08 4.92 4.33.69.3 1.22.48 1.63.62.68.22 1.3.19 1.79.12.55-.08 1.7-.7 1.94-1.38.24-.68.24-1.26.17-1.38-.07-.12-.26-.19-.55-.34Z"/>
          </svg>
        </span>
        <span class="fab-text">
          <span class="fab-subtitle">S√≠guenos en:</span>
          <a class="fab-title" href="https://whatsapp.com/channel/0029VagyKOKL7UVb2wxnh502"
             target="_blank" rel="noopener" data-name="KaChu New">KaChu New</a>
        </span>
      </button>
    </div>
  </div>

  <!-- ZONA DE PRODUCTOS -->
  <main class="container">
    <section class="grid"></section>
    <div id="emptyState" class="empty hidden"></div>
  </main>

  <!-- BOT√ìN FLOTANTE CARRITO -->
  <button id="btnCart" class="fab" aria-label="Carrito" type="button">
    üõí
    <span class="badge" id="cartBadge">2</span>
  </button>

  <!-- MODAL CARRITO -->
  <div id="modalCart" class="modal" aria-hidden="true">
    <div class="modal__overlay" data-close="cart"></div>
    <div class="modal__content" role="dialog" aria-modal="true" aria-labelledby="cartTitle">
      <button class="modal__close" data-close="cart" aria-label="Cerrar" type="button">‚úï</button>
      <h2 id="cartTitle">Tu carrito</h2>
      <ul class="cart-list" id="cartList"></ul>
      <div class="cart-total">
        <div class="sum-row">
          <span>Total:</span>
          <strong id="cartTotal"></strong>
        </div>
        <p class="note">NOTA: El total cambia dependiendo zona y tipo de pago | los precios mostrados son exclusivos del cat√°logo.</p>
      </div>
      <div class="actions">
        <button id="btnClearCart" class="btn ghost" disabled type="button">Vaciar/Carrito</button>
        <button id="btnContinue" class="btn primary" disabled type="button">Continuar</button>
      </div>
    </div>
  </div>

  <!-- FREE SHIPPING PROMO PILL -->
  <div id="fs-promo" class="fs-pill hidden" aria-live="polite">
    <div class="fs-msg">Agrega <strong>$0.00</strong> al carrito para conseguir Env√≠o <strong>GRATIS</strong>.</div>
    <div class="fs-progress"><div class="fs-bar"></div></div>
  </div>

<!-- ================== MODAL: Ver todos =================== -->
<div class="modal" id="modalFavs" aria-hidden="true" inert>
  <div class="modal__overlay" data-close="favs" aria-hidden="true"></div>

  <div class="modal__content" role="dialog" aria-modal="true" aria-labelledby="favsModalTitle">
    <button class="modal__close" type="button" data-close="favs" aria-label="Cerrar">‚úï</button>

    <h2 id="favsModalTitle" style="margin-top:0">Todos tus favoritos</h2>

    <!-- Contenedor donde el JS renderiza la grilla de favoritos -->
    <div id="favsModalList" class="favs-modal-grid">
      <!-- JS inyecta .favs-modal-card -->
    </div>
  </div>
</div>
<!-- ================= /MODAL: Ver todos =================== -->


  <!-- MODAL CHECKOUT -->
  <div id="modalCheckout" class="modal" aria-hidden="true">
    <div class="modal__overlay" data-close="checkout"></div>
    <div class="modal__content" role="dialog" aria-modal="true" aria-labelledby="checkoutTitle">
      <button class="modal__close" data-close="checkout" aria-label="Cerrar" type="button">‚úï</button>
      <h2 id="checkoutTitle">Finalizar pedido</h2>

      <form id="checkoutForm" class="form">
        <label class="field">
          <span>Zona de entrega</span>
          <select id="zone" required>
            <option value="">Selecciona una zona‚Ä¶</option>
          </select>
        </label>

        <fieldset class="field radios">
          <legend>M√©todo de pago</legend>
          <label><input type="radio" name="pay" value="Efectivo" required> Efectivo</label>
          <label><input type="radio" name="pay" value="Tarjeta" required> Tarjeta</label>
          <label><input type="radio" name="pay" value="Transferencia"> Transferencia</label>
        </fieldset>

<!-- PAGO DIVIDIDO -->
<div class="split-pay">
  <label class="switch">
    <input type="checkbox" id="twoPaymentsSwitch">
    <span>Quiero pagar con 2 m√©todos</span>
  </label>

  <div id="splitPayFields" class="hidden">
    <div class="split-row">
      <div class="field">
        <span>M√©todo 1</span>
        <select id="payMethod1">
          <option value="Efectivo">Efectivo</option>
          <option value="Tarjeta">Tarjeta</option>
          <option value="Transferencia">Transferencia</option>
        </select>
      </div>
      <div class="field">
        <span>Monto 1</span>
        <input type="number" id="payAmount1" min="0" step="0.01" placeholder="0.00">
      </div>
    </div>

    <div class="split-row">
      <div class="field">
        <span>M√©todo 2</span>
        <select id="payMethod2">
          <option value="Efectivo">Efectivo</option>
          <option value="Tarjeta">Tarjeta</option>
          <option value="Transferencia">Transferencia</option>
        </select>
      </div>
      <div class="field">
        <span>Monto 2</span>
        <input type="number" id="payAmount2" min="0" step="0.01" placeholder="0.00">
      </div>
    </div>

    <div class="split-summary">
      <div>Subtotal + env√≠o: <strong id="splitSubtotal">$0.00</strong></div>
      <div>Comisi√≥n por tarjeta: <strong id="splitFee">$0.00</strong></div>
      <div>Total a pagar: <strong id="splitTotal">$0.00</strong></div>
      <div class="muted">Si hay efectivo, calculamos el cambio autom√°ticamente.</div>
      <div>Cambio estimado: <strong id="splitChange">$0.00</strong></div>
    </div>
  </div>
</div>


        <label class="field hidden" id="cashField">
          <span>¬øCon cu√°nto vas a pagar?</span>
          <input type="number" id="cashGiven" placeholder="Ej. 200.00" min="0" step="0.01">
          <small id="cashHelp" class="cash-help"></small>
        </label>

        <label class="field">
          <span>Direcci√≥n</span>
          <textarea id="address" rows="3" placeholder="Calle y n√∫mero (entre calles)" required></textarea>
          <span id="checkoutTotalPill" class="total-pill" style="margin-left:10px;font-weight:600;">Total: $0.00</span>
        </label>

        <div class="actions">
          <button type="button" id="btnCancel" class="btn ghost">Cancelar</button>
          <button type="submit" id="btnWhatsApp" class="btn primary" disabled>Enviar por WhatsApp</button>
          <p class="muted" style="margin-top:.5rem">
            Al enviar aceptas el tratamiento de tus datos solo para procesar tu pedido por WhatsApp.
            La informaci√≥n no se guarda en nuestros servidores. Consulta el 
            <a href="/privacidad.html" target="_blank" rel="noopener">Aviso de Privacidad</a>.
          </p>
        </div>
      </form>
    </div>
  </div>

  <!-- MODAL CONFIRMAR ENV√çO -->
  <div id="modalConfirm" class="modal" aria-hidden="true">
    <div class="modal__overlay" data-close="confirm"></div>
    <div class="modal__content" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
      <button class="modal__close" data-close="confirm" aria-label="Cerrar" type="button">‚úï</button>
      <h2 id="confirmTitle">¬øSe envi√≥ correctamente tu pedido por WhatsApp?</h2>
      <p>Si ya lo enviaste y todo bien, liberaremos tu carrito para un proximo pedido, de lo contrario tu carrito sigue tal cual como lo dejaste.</p>
      <div class="actions" style="display:flex; gap:10px;">
        <button id="btnConfirmNo" class="btn ghost" type="button">No, mantener</button>
        <button id="btnConfirmYes" class="btn primary" type="button">S√≠, limpiar</button>
      </div>
    </div>
  </div>

  <!-- Modal: Aviso Transferencia -->
  <div class="modal" id="modalTransferencia" aria-hidden="true">
    <div class="modal__content">
      <h2>Aviso para: Transferencia</h2>
      <p style="margin:8px 0 12px; font-weight:600;">
        Con este m√©todo de pago la entrega de tu pedido puede tardar un poco m√°s de lo establecido.
      </p>
      <ol style="padding-left:18px; line-height:1.5;">
        <li>Env√≠a tu pedido normalmente.</li>
        <li>Espera en el chat mientras se te env√≠an los datos para transferir.</li>
        <li>Realiza el pago.</li>
        <li><strong>Deber√°s adjuntar captura(Obligatorio).</strong></li>
        <li>Esperaremos a que tu transferencia se refleje en nuestra banca.</li>
        <li>Una vez reflejada, procederemos a enviar tu pedido.</li>
      </ol>
      <div class="sum-row" style="margin-top:14px;">
        <span></span>
        <div style="display:flex; gap:8px;">
          <button class="btn primary" id="btnTransferOK" type="button">Entendido</button>
        </div>
      </div>
    </div>
  </div>

  <!-- En el <head> o antes de cerrar </body> -->
<script>
/* ====== Mini Pop-up KaChu ‚Äî Cliente (Cat√°logo) ======
   - Endpoints que intenta (en orden): window.KACHU_ADS_ENDPOINT, /api/data/ads, /api/data/ad.json, /api/ads, /ads.json
   - Estructura esperada: { enabled: boolean, displayMs?: number, pauseMs?: number, items: [{ l1, l2, ctaText?, ctaUrl? }] }
   - No requiere HTML previo: inserta el contenedor y estilos autom√°ticamente.
*/

(function(){
  const CANDIDATE_ENDPOINTS = [
    typeof window !== 'undefined' && window.KACHU_ADS_ENDPOINT ? window.KACHU_ADS_ENDPOINT : null,
    '/data/ads',
    '/data/ads.json',
    '/ads',
    '/ads.json'
  ].filter(Boolean);

  const DEFAULTS = { displayMs: 6000, pauseMs: 10000 };
  const STYLE_ID = 'kachu-ads-style';
  const WRAP_ID  = 'popupKachu';

  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Utilitarios ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const $  = (s, ctx=document) => ctx.querySelector(s);
  function isNonEmptyStr(v){ return typeof v === 'string' && v.trim().length > 0; }
  function sanitizeURL(u){
    try {
      const url = new URL(u, location.origin);
      // Permite http(s) √∫nicamente
      if (!/^https?:$/.test(url.protocol)) return null;
      return url.href;
    } catch { return null; }
  }
  async function fetchFirstOk(urls){
    for (const u of urls){
      try{
        const r = await fetch(u, { cache:'no-store' });
        if (!r.ok) continue;
        const data = await r.json();
        return { url: u, data };
      }catch{ /* siguiente */ }
    }
    return null;
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Estilos (se inyectan 1 sola vez) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function injectStylesOnce(){
    if (document.getElementById(STYLE_ID)) return;
    const css = `
      :root{ --kachu-black:#111; --kachu-white:#fff; --shadow:0 10px 30px rgba(0,0,0,.15); --z-ads:900; }
      @media (prefers-reduced-motion: reduce){
        *{animation-duration:.001ms !important;animation-iteration-count:1 !important;transition-duration:.001ms !important}
      }
      #${WRAP_ID}{
        position:fixed; left:16px; bottom:16px; z-index:var(--z-ads);
        width:min(92vw, 340px);
        background:var(--kachu-white);
        border:1px solid #eee; border-radius:16px;
        padding:14px 16px 16px; display:none;
        box-shadow:var(--shadow);
      }
      #${WRAP_ID} .l1{font-weight:900;margin:0 22px 4px 0;color:var(--kachu-black)}
      #${WRAP_ID} .l2{margin:0 22px 8px 0;color:#333;font-size:14px}
      #${WRAP_ID} .cta{font-weight:800;text-decoration:underline;color:var(--kachu-black)}
      #${WRAP_ID} .ad-close{
        position:absolute; top:6px; right:8px; border:0; background:transparent;
        font:inherit; cursor:pointer; opacity:.6
      }
      #${WRAP_ID} .ad-close:hover{opacity:1}
      .kachu-in{animation:kachuSlideIn .28s ease forwards}
      .kachu-out{animation:kachuSlideOut .26s ease forwards}
      @keyframes kachuSlideIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
      @keyframes kachuSlideOut{to{opacity:0;transform:translateY(12px)}}
    `.trim();
    const style = document.createElement('style');
    style.id = STYLE_ID;
    style.textContent = css;
    document.head.appendChild(style);
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ DOM: contenedor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function ensureWrapper(){
    let el = document.getElementById(WRAP_ID);
    if (el) return el;
    el = document.createElement('section');
    el.id = WRAP_ID;
    el.setAttribute('role','dialog');
    el.setAttribute('aria-live','polite');
    el.setAttribute('aria-label','Notificaci√≥n');

    el.innerHTML = `
      <button class="ad-close" aria-label="Cerrar notificaci√≥n">‚úï</button>
      <p class="l1"></p>
      <p class="l2"></p>
    `;
    document.body.appendChild(el);
    return el;
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ L√≥gica de ciclo ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function Popper(config){
    const { enabled, displayMs, pauseMs, items } = config;
    const el = ensureWrapper();
    const closeBtn = $('.ad-close', el);
    const l1 = $('.l1', el);
    const l2 = $('.l2', el);

    let idx = 0;
    let timers = [];
    let running = false;

    function setContent(i){
      const it = items[i];
      // l1 + l2 como texto
      l1.textContent = it.l1 || '';
      l2.textContent = it.l2 || '';
      // a√±adir CTA si existe
      const oldA = l2.querySelector('a.cta');
      if (oldA) oldA.remove();
      if (it.link && isNonEmptyStr(it.link.text) && isNonEmptyStr(it.link.url)){
        const a = document.createElement('a');
        a.className = 'cta';
        a.textContent = it.link.text;
        a.href = it.link.url;
        a.target = '_blank';
        a.rel = 'noopener';
        // espacio si l2 no termina en espacio
        if (l2.lastChild && l2.lastChild.nodeType === Node.TEXT_NODE && !/\s$/.test(l2.lastChild.textContent||'')){
          l2.appendChild(document.createTextNode(' '));
        }
        l2.appendChild(a);
      }
    }

    function animateIn(){
      el.classList.remove('kachu-out');
      el.style.display = 'block';
      // reflow para reiniciar animaci√≥n
      void el.offsetWidth;
      el.classList.add('kachu-in');
    }
    function animateOut(cb){
      el.classList.remove('kachu-in');
      el.classList.add('kachu-out');
      const t = setTimeout(()=>{ el.style.display='none'; cb && cb(); }, 240);
      timers.push(t);
    }

    function cycleOnce(){
      if (!running) return;
      setContent(idx);
      animateIn();
      const t1 = setTimeout(()=>{
        animateOut(()=>{
          if (!running) return;
          idx = (idx + 1) % items.length;
          const t2 = setTimeout(()=>{ cycleOnce(); }, 1100 + pauseMs);
          timers.push(t2);
        });
      }, displayMs);
      timers.push(t1);
    }

    function start(){
      if (running) return;
      running = true;
      el.style.display = 'block';
      timers.push(setTimeout(()=>cycleOnce(), 50));
    }
    function stop(hideNow=false){
      running = false;
      timers.forEach(clearTimeout);
      timers = [];
      if (hideNow){
        el.style.display='none';
        el.classList.remove('kachu-in','kachu-out');
      }
    }

    // Eventos
    closeBtn.addEventListener('click', ()=> stop(true));
    document.addEventListener('visibilitychange', ()=>{
      if (document.hidden) stop(true);
      else if (enabled) start();
    });

    // API p√∫blica m√≠nima
    return { start, stop, el };
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Normalizaci√≥n del payload ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function normalizePayload(raw){
    // Acepta: {enabled, displayMs, pauseMs, items:[{l1,l2,ctaText?,ctaUrl?}]}
    const enabled = !!raw?.enabled;
    const displayMs = Number.isFinite(+raw?.displayMs) && +raw.displayMs > 0 ? +raw.displayMs : DEFAULTS.displayMs;
    const pauseMs   = Number.isFinite(+raw?.pauseMs)   && +raw.pauseMs   > 0 ? +raw.pauseMs   : DEFAULTS.pauseMs;

    let items = Array.isArray(raw?.items) ? raw.items : [];
    items = items
      .map(it => {
        const l1 = isNonEmptyStr(it?.l1) ? it.l1.trim() : '';
        const l2 = isNonEmptyStr(it?.l2) ? it.l2.trim() : '';
        const ctaText = isNonEmptyStr(it?.ctaText) ? it.ctaText.trim() : '';
        const ctaUrl  = sanitizeURL(it?.ctaUrl || '');
        const link = (ctaText && ctaUrl) ? { text: ctaText, url: ctaUrl } : null;
        // Permite filtrar (opcional) por "show: false"
        const show = (typeof it?.show === 'boolean') ? !!it.show : true;
        return { l1, l2, link, show };
      })
      .filter(it => it.show && (isNonEmptyStr(it.l1) || isNonEmptyStr(it.l2)));

    return { enabled, displayMs, pauseMs, items };
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Bootstrap ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  async function boot(){
    try {
      injectStylesOnce();
      const found = await fetchFirstOk(CANDIDATE_ENDPOINTS);
      if (!found || !found.data) return; // no mostramos nada
      const cfg = normalizePayload(found.data);
      if (!cfg.enabled || cfg.items.length === 0) return; // desactivado o sin mensajes => no mostrar
      // Esperar a que exista body/DOM
      const ready = (document.readyState === 'loading')
        ? new Promise(res => document.addEventListener('DOMContentLoaded', res, { once:true }))
        : Promise.resolve();
      await ready;
      const popper = Popper(cfg);
      popper.start();
    } catch (err) {
      // Silencioso en producci√≥n para no molestar al usuario final
      // console.warn('Ads popup error:', err);
    }
  }

  boot();
})();
</script>

  <script src="script.js?v=kg3-tiers" defer></script>
</body>
</html>